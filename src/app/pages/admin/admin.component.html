<main>

    <h1 class="center">Ajouter une recette</h1>

    <div class="form-box">

        <form [formGroup]="recipe_form" (ngSubmit)="addRecipe()">

            <div>
                <label for="title">Titre :
                    <input placeholder="Titre" formControlName="title" id="title" type="text" required>
                </label>
            </div>

            <div>
                <label for="idCategory">Catégorie : </label>
                <div class="select-container">
                    <select formControlName="idCategory" id="idCategory">
                        <option value="">-</option>
                        @for (cat of categories; track cat) {
                            <option [value]="cat.id">{{cat.title}}</option>
                        }
                        @empty {
                            <option value="">Entrée</option>
                            <option value="">Plat</option>
                            <option value="">Désert</option>
                        }
                    </select>
                    <div class="arrow-down"></div>
                </div>
            </div>

            <div>
                <label for="numberPeople">Nombre de personnes :
                    <input placeholder="Nombre de personnes" formControlName="numberPeople" id="numberPeople" type="number" required>
                </label>
            </div>

            <div>
                <label for="duration">Durée :
                    <input placeholder="Durée" formControlName="duration" id="duration" type="number" required>
                </label>
            </div>

            <div>
                <label for="picture">Photo :
                    <input placeholder="Photo" formControlName="picture" id="picture" type="text" required>
                </label>
            </div>

            <div>
                <label for="idNutrition">Régime : </label>
                <div class="select-container">
                    <select formControlName="idNutrition" id="idNutrition">
                        <option value="0">-</option>
                        @for (nut of nutritions; track nut) {
                            <option [value]="nut.id">{{nut.title}}</option>
                        }
                        @empty {
                            <option value="1">Végétarisme</option>
                            <option value="2">Sans lactose</option>
                            <option value="3">Sans gluten</option>
                        }
                    </select>
                    <div class="arrow-down"></div>
                </div>
            </div>


            <h3>Ingrédients :</h3>

            <div formArrayName="ingredients" id="ingredients_container">
                @for (ingredient of ingredientsArray.controls; track ingredient; let i = $index) {
                    <div [formGroupName]="i">
                        <label for="ingredient">Ingrédient :</label>
                        <div class="select-input-container">
                            <div class="select-container">
                                <select formControlName="id" id="ingredient-{{ i }}">
                                <option value="">-</option>
                                @for (ing of ingredients; track ing;) {
                                    <option [value]="ing.id">{{ ing.title }}</option>
                                }
                                @empty {
                                    <option value="1">Farine</option>
                                    <option value="2">Lait</option>
                                    <option value="3">Oeuf</option>
                                    <option value="4">Sucre</option>
                                    <option value="5">Sel</option>
                                    <option value="6">Levure</option>
                                }
                                </select>
                                <div class="arrow-down"></div>
                            </div>
                            <div class="mini-input-container">
                                <label for="quantity-{{ i }}">
                                <input formControlName="quantity" id="quantity-{{ i }}" type="number" class="mini-input" required>
                                <div class="icon-gr">gr/ml</div>
                                </label>
                            </div>
                        </div>
                    </div>
                }
            </div>

            <button type="button" (click)="addIngredient()" class="micro-btn">Ajouter un ingrédient</button>
            <button type="button" (click)="deleteIngredient()" class="micro-btn">Supprimer le dernier ingrédient</button>

			<div>
                <label for="description">Description :</label>
                <textarea formControlName="description" id="description"></textarea>
            </div>


            <h3>Instructions :</h3>

            <div formArrayName="instructions" id="instructions_container">
                @for (instruction of instructions.controls; track instruction; let i = $index) {
                    <div [formGroupName]="i">
                        <label [for]="'instruction' + (i + 1)">Étape {{ i + 1 }} :</label>
                        <textarea formControlName="text" [id]="'instruction' + (i + 1)" required></textarea>
                    </div>
                }
            </div>

            <button type="button" (click)="addInstruction()" class="micro-btn">Ajouter une étape</button>
            <button type="button" (click)="deleteInstruction()" class="micro-btn">Supprimer la dernière étape</button>

            <div class="right">
                <button class="btn btn-success" type="submit">Valider</button>
            </div>

        </form>

    </div>

</main>
